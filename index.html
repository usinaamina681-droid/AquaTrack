<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>AquaTrack — мониторинг миграции рыб</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --blue: #2563eb;
      --red: #dc2626;
      --gray: #6b7280;
      --light-gray: #e5e7eb;
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: white;
      color: #111827;
    }

    header {
      padding: 32px;
      border-bottom: 1px solid var(--light-gray);
    }

    header h1 {
      margin: 0;
      font-size: 28px;
      color: var(--blue);
    }

    header p {
      margin-top: 8px;
      color: var(--gray);
    }

    section {
      padding: 32px;
      border-bottom: 1px solid var(--light-gray);
    }

    h2 {
      margin-bottom: 16px;
      font-size: 20px;
    }

    .river {
      display: flex;
      gap: 24px;
    }

    .zone {
      flex: 1;
      padding: 24px;
      border: 2px solid var(--blue);
      border-radius: 12px;
      text-align: center;
      transition: 0.3s;
    }

    .zone.warning {
      border-color: var(--red);
      background: #fee2e2;
    }

    .zone h3 {
      margin-bottom: 8px;
    }

    .detector {
      margin-top: 12px;
      font-size: 14px;
      color: var(--gray);
    }

    .controls button {
      margin-right: 12px;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      background: var(--blue);
      color: white;
      cursor: pointer;
      font-size: 14px;
    }

    .controls button.secondary {
      background: #9ca3af;
    }


    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
    }

    th, td {
      border-bottom: 1px solid var(--light-gray);
      padding: 12px;
      text-align: left;
    }

    th {
      color: var(--gray);
      font-weight: 600;
    }

    
    .alert {
      margin-top: 16px;
      padding: 16px;
      border-radius: 8px;
      background: #fee2e2;
      color: var(--red);
      font-weight: 600;
      display: none;
    }

    .explanation {
      color: var(--gray);
      max-width: 800px;
      line-height: 1.6;
    }

    .counter {
      font-size: 32px;
      font-weight: 700;
      margin-top: 8px;
    }
  </style>
</head>
<body>

<header>
  <h1>AquaTrack</h1>
  <p>Система мониторинга миграции рыб и выявления браконьерства</p>
</header>

<section>
  <h2>Детектор</h2>
  <div class="river">
    <div class="zone" id="zoneA">
      <h3>Zone A</h3>
      <div class="counter" id="countA">0</div>
      <div class="detector">Миграционный детектор (концепт)</div>
    </div>
    <div class="zone" id="zoneB">
      <h3>Zone B (зона риска)</h3>
      <div class="counter" id="countB">0</div>
      <div class="detector">Миграционный детектор (концепт)</div>
    </div>
  </div>
</section>

<section>
  <h2>Количество проплывших рыб</h2>
  <div class="controls">
    <button onclick="passA()">Рыба прошла через Zone A</button>
    <button onclick="passB()">Рыба прошла через Zone B</button>
    <button class="secondary" onclick="resetSim()">Сбросить симуляцию</button>
    <button onclick="saveSession()">Сохранить данные мониторинга</button>
  </div>
</section>

<section>
  <h2>Данные мониторинга</h2>
  <table>
    <thead>
      <tr>
        <th>Зона</th>
        <th>Количество рыб</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Zone A</td>
        <td id="tableA">0</td>
      </tr>
      <tr>
        <td>Zone B</td>
        <td id="tableB">0</td>
      </tr>
    </tbody>
  </table>
</section>

<section>
  <h2>Аналитика</h2>
  <p>Потери: <strong><span id="loss">0</span>%</strong></p>
  <div class="alert" id="alert">
    ⚠ Возможная браконьерская активность в зоне B
  </div>
</section>

<section>
  <h2>Статистика за всё время</h2>

  <table>
    <thead>
      <tr>
        <th>Дата</th>
        <th>Zone A</th>
        <th>Zone B</th>
        <th>Потери (%)</th>
      </tr>
    </thead>
    <tbody id="historyTable">
      <!-- данные появятся автоматически -->
    </tbody>
  </table>
</section>

<section>
  <h2>Объяснение</h2>
  <p class="explanation">
    В реальной системе используются подводные датчики и чипированные рыбы.
    В данном прототипе данные эмулируются для демонстрации логики работы
    системы мониторинга и выявления аномального сокращения популяции.
  </p>
</section>

<script>
  let zoneA = 0;
  let zoneB = 0;

  function updateUI() {
    document.getElementById('countA').innerText = zoneA;
    document.getElementById('countB').innerText = zoneB;
    document.getElementById('tableA').innerText = zoneA;
    document.getElementById('tableB').innerText = zoneB;

    let lossPercent = zoneA === 0 ? 0 : Math.round(((zoneA - zoneB) / zoneA) * 100);
    document.getElementById('loss').innerText = lossPercent;

    const alert = document.getElementById('alert');
    const zoneBEl = document.getElementById('zoneB');

    if (lossPercent > 30) {
      alert.style.display = 'block';
      zoneBEl.classList.add('warning');
    } else {
      alert.style.display = 'none';
      zoneBEl.classList.remove('warning');
    }
  }

  function passA() {
    zoneA++;
    updateUI();
  }

  function passB() {
    if (zoneB < zoneA) zoneB++;
    updateUI();
  }

  function resetSim() {
    zoneA = 0;
    zoneB = 0;
    updateUI();
  }
</script>

<script>
  const STORAGE_KEY = 'aquatrack_history';

  function saveSession() {
    if (zoneA === 0) return;

    const history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

    const lossPercent = Math.round(((zoneA - zoneB) / zoneA) * 100);

    history.push({
      date: new Date().toLocaleString(),
      zoneA,
      zoneB,
      loss: lossPercent
    });

    localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
    renderHistory();
  }

  function renderHistory() {
    const history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    const table = document.getElementById('historyTable');

    table.innerHTML = '';

    history.forEach(item => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${item.date}</td>
        <td>${item.zoneA}</td>
        <td>${item.zoneB}</td>
        <td>${item.loss}%</td>
      `;
      table.appendChild(row);
    });
  }

  // Загружаем историю при открытии сайта
  renderHistory();
</script>

</body>

</html>