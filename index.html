<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>AquaTrack - fish migration monitoring</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --blue: #2563eb;
      --red: #dc2626;
      --gray: #6b7280;
      --light-gray: #e5e7eb;
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: white;
      color: #111827;
    }

    header, section {
      padding: 32px;
      border-bottom: 1px solid var(--light-gray);
    }

    h1 { margin: 0; color: var(--blue); }
    h2 { margin-bottom: 16px; }

    .river {
      display: flex;
      gap: 24px;
    }

    .zone {
      flex: 1;
      padding: 24px;
      border: 2px solid var(--blue);
      border-radius: 12px;
      text-align: center;
      transition: 0.3s;
    }

    .zone.warning {
      border-color: var(--red);
      background: #fee2e2;
    }

    .counter {
      font-size: 32px;
      font-weight: 700;
      margin-top: 8px;
    }

    .controls button {
      margin-right: 12px;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      background: var(--blue);
      color: white;
      cursor: pointer;
    }

    .controls button.secondary {
      background: #9ca3af;
    }

    .alert {
      margin-top: 16px;
      padding: 16px;
      border-radius: 8px;
      background: #fee2e2;
      color: var(--red);
      font-weight: 600;
      display: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
    }

    th, td {
      border-bottom: 1px solid var(--light-gray);
      padding: 12px;
    }

    th { color: var(--gray); }
  </style>
</head>

<body>

<header>
  <h1>AquaTrack</h1>
  <p>Monitoring fish migration and detecting poaching</p>
</header>

<section>
  <h2>Детектор</h2>
  <div class="river">
    <div class="zone" id="zoneA">
      <h3>Zone A</h3>
      <div class="counter" id="countA">0</div>
    </div>

    <div class="zone" id="zoneB">
      <h3>Zone B </h3>
      <div class="counter" id="countB">0</div>
    </div>

    <div class="zone" id="zoneC">
      <h3>Zone C</h3>
      <div class="counter" id="countC">0</div>
    </div>
  </div>
</section>

<section>
  <h2>Management</h2>
  <div class="controls">
    <button onclick="passA()">Рыба → Zone A</button>
    <button onclick="passB()">Рыба → Zone B</button>
    <button onclick="passC()">Рыба → Zone C</button>
    <button class="secondary" onclick="resetSim()">Reset</button>
    <button onclick="saveSession()">Save data</button>
  </div>
</section>

<section>
  <h2>Analytics</h2>
  <p>Losses A → B: <strong><span id="lossAB">0</span>%</strong></p>
  <p>Losses B → C: <strong><span id="lossBC">0</span>%</strong></p>

  <div class="alert" id="alert">
    ⚠ Losses detected. Poaching activity is possible.
  </div>
</section>

<section>
  <h2>Statistics for all time</h2>

  <table>
    <thead>
      <tr>
        <th>Дата</th>
        <th>Zone A</th>
        <th>Zone B</th>
        <th>Zone C</th>
        <th>Потери A→B (%)</th>
      </tr>
    </thead>
    <tbody id="historyTable">
    </tbody>
  </table>
</section>

<script>
  const STORAGE_KEY = 'aquatrack_history';

  function saveSession() {
    if (zoneA === 0) return;

    const history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];

    const lossAB = zoneA === 0 ? 0 :
      Math.round(((zoneA - zoneB) / zoneA) * 100);

    history.push({
      date: new Date().toLocaleString(),
      zoneA,
      zoneB,
      zoneC,
      lossAB
    });

    localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
    renderHistory();
  }

  function renderHistory() {
    const history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
    const table = document.getElementById("historyTable");
    if (!table) return;

    table.innerHTML = "";

    history.forEach(item => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${item.date}</td>
        <td>${item.zoneA}</td>
        <td>${item.zoneB}</td>
        <td>${item.zoneC}</td>
        <td>${item.lossAB}%</td>
      `;
      table.appendChild(row);
    });
  }

  renderHistory();
</script>

<script>
  let zoneA = 0;
  let zoneB = 0;
  let zoneC = 0;

  function updateUI() {
    countA.innerText = zoneA;
    countB.innerText = zoneB;
    countC.innerText = zoneC;

    const lossAB = zoneA === 0 ? 0 : Math.round(((zoneA - zoneB) / zoneA) * 100);
    const lossBC = zoneB === 0 ? 0 : Math.round(((zoneB - zoneC) / zoneB) * 100);

    lossABSpan.innerText = lossAB;
    lossBCSpan.innerText = lossBC;

    alertBox.style.display = (lossAB > 30 || lossBC > 30) ? "block" : "none";

    zoneBEl.classList.toggle("warning", lossAB > 30);
    zoneCEl.classList.toggle("warning", lossBC > 30);
  }

  function passA() {
    zoneA++;
    updateUI();
  }

  function passB() {
    if (zoneB < zoneA) zoneB++;
    updateUI();
  }

  function passC() {
    if (zoneC < zoneB) zoneC++;
    updateUI();
  }

  function resetSim() {
    zoneA = zoneB = zoneC = 0;
    updateUI();
  }

  const countA = document.getElementById("countA");
  const countB = document.getElementById("countB");
  const countC = document.getElementById("countC");

  const lossABSpan = document.getElementById("lossAB");
  const lossBCSpan = document.getElementById("lossBC");

  const alertBox = document.getElementById("alert");
  const zoneBEl = document.getElementById("zoneB");
  const zoneCEl = document.getElementById("zoneC");
</script>

</body>
</html>



